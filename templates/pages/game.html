<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Game</title>
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='css/style.css') }}"
    />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Fredoka:wght@300..700&display=swap"
      rel="stylesheet"
    />
    <style>
      .kotak_materi_diatas {
        left: -2%;
        position: relative;
        margin: 30px auto 0px auto !important;
        width: 30%;
      }
      .tulisan_materi_diatas {
        font-size: 50px !important;
        position: absolute !important;
        top: 25px !important;
        left: 50% !important;
        transform: translateX(-50%);
        width: max-content;
      }
      .kotak_materi_panjang {
        left: 10% !important;
        width: 23% !important;
      }
      #kotak_materi_2 {
        left: 36.8% !important;
      }
      #kotak_materi_3 {
        left: 63.65% !important;
      }
      .tulisan_rumah_adat {
        font-size: 34px;
        top: -5px !important;
      }

      /* EFEK TERKUNCI */
      /* Membuat kotak jadi abu-abu, agak transparan, dan kursor dilarang */
      .locked {
        filter: grayscale(100%);
        opacity: 0.8;
        cursor: not-allowed;
        background-color: #bfbfbf !important;
      }
      /* Agar gambar gembok posisinya pas di tengah */
      .locked img {
        margin-top: 40px !important;
        width: 200px !important;
      }

      /* ============================
   RESPONSIVE UNTUK HP (‚â§ 768px)
=============================== */
      @media (max-width: 768px) {
        body {
          text-align: center;
          overflow-x: hidden;
        }
        .back {
          position: absolute !important;
          width: 48px;
          height: 48px;
          top: 12px;
          left: 12px;
          margin: 0 !important;
          z-index: 12000;
        }
        .gambar_back {
          width: 28px;
          height: 28px;
          top: 10px;
          left: 10px;
        }
        .profil {
          position: absolute !important;
          width: 48px;
          height: 48px;
          top: 12px !important;
          right: 12px !important;
          margin: 0 !important;
          left: auto !important;
          bottom: auto !important;
          z-index: 12000;
          display: flex;
          justify-content: center;
          align-items: center;
        }
        .gambarorang {
          width: 28px !important;
          height: 28px !important;
          margin: 0 !important;
          position: relative !important;
          left: 14px !important;
          bottom: 25px;
        }
        .kotak_materi_diatas {
          position: absolute !important;
          top: 12px;
          left: 50%;
          transform: translateX(-50%);
          width: 150px;
          height: 42px;
          border-width: 3px;
          border-radius: 40px;
          margin: 0 !important;
          z-index: 9000;
        }
        .tulisan_materi_diatas {
          font-size: 18px !important;
          position: fixed !important;
          top: 10px !important;
          left: 50% !important;
          transform: translateX(-50%);
        }
        .kotak_materi_panjang {
          position: relative !important;
          width: 260px !important;
          height: 350px !important;
          margin: 110px auto 30px auto !important;
          top: 0 !important;
          left: 0 !important;
        }
        #kotak_materi_2 {
          left: 0% !important;
          margin-top: -0px !important;
        }
        #kotak_materi_3 {
          left: 0% !important;
          margin-top: -0px !important;
        }
        .kotak_materi_panjang img {
          height: 150px !important;
          margin-top: 60px !important;
        }
        .tulisan_rumah_adat {
          font-size: 26px !important;
          margin-top: 15px !important;
          text-align: center !important;
        }
        .ornamen-banjar {
          width: 180px !important;
          right: -30px !important;
          bottom: -50px !important;
        }
        .kotak_biru {
          width: 90%;
          height: 80vh;
          top: 380px;
        }
        .kotak_biru_muda {
          width: 85%;
          height: 73vh;
          top: 380px;
        }
        .help {
          width: 90% !important;
          height: 70vh !important;
          left: 50%;
          transform: translateX(-50%);
        }
        a {
          text-decoration: none;
        }
      }
    </style>
  </head>
  <body>
    <a href="{{ url_for('home') }}"
      ><div class="back">
        <img
          src="/static/Image/back.png"
          alt="gambar kembali"
          class="gambar_back"
        /></div
    ></a>
    <div
      class="profil"
      onclick="penjelasan()"
      style="top: 110px; position: absolute; right: 30px"
    >
      <a href="#" class="profiluser"
        ><img src="/static/Image/help.png" alt="help" class="gambarorang"
      /></a>
    </div>

    <div class="buat_profil" style="display: none">
      <div class="kotak_biru"></div>
      <div class="kotak_biru_muda">
        <div class="help">
          <h2>üéÆ HALAMAN BANTUAN (HELP)</h2>
          <h3>üëã Selamat Datang!</h3>
          <p>Mainkan game secara berurutan untuk membuka game berikutnya!</p>
          <h3>üß† 1. Game Kuis</h3>
          <p>Jawab pertanyaan seputar budaya Banjar.</p>
          <h3>üñºÔ∏è 2. Game Tebak Gambar</h3>
          <p><strong>Syarat Buka:</strong> Lulus Stage 5 Game Kuis.</p>
          <h3>üîó 3. Matching Game</h3>
          <p><strong>Syarat Buka:</strong> Lulus Stage 9 Game Tebak Gambar.</p>
        </div>
      </div>
    </div>

    <div class="kotak_materi_diatas">
      <div class="tulisan_materi_diatas" style="left: 199px">Game</div>
    </div>

    <a href="{{ url_for('quiz') }}"
      ><div class="kotak_materi_panjang" style="left: 200px">
        <div class="rumah_adat">
          <img
            src="/static/Image/quiz.png"
            alt="quiz"
            class="gambar_rumah"
            style="left: 56px"
          />
          <p class="tulisan_rumah_adat" style="left: 105px">Quiz</p>
        </div>
      </div></a
    >

    <a
      href="{{ url_for('tebak_gambar') if unlock_tebak else '#' }}"
      id="link_tebak"
    >
      <div class="kotak_materi_panjang" id="kotak_materi_2" style="left: 621px">
        <div class="kue_banjar">
          <img
            src="/static/Image/tebakgambar.png"
            alt="tebak gambar"
            class="gambar_makanan"
            style="left: 53.7px"
          />
          <p class="tulisan_rumah_adat" style="left: 12px">Tebak Gambar</p>
        </div>
      </div>
    </a>

    <a
      href="{{ url_for('matching') if unlock_matching else '#' }}"
      id="link_matching"
    >
      <div
        class="kotak_materi_panjang"
        id="kotak_materi_3"
        style="left: 1040px"
      >
        <div class="kue_banjar">
          <img
            src="/static/Image/dragdrop.png"
            alt="matching"
            class="gambar_makanan"
            style="left: 53.5px"
          />
          <p class="tulisan_rumah_adat" id="kue" style="left: 58.5px">
            Matching
          </p>
        </div>
      </div>
    </a>

    <img src="/static/Image/ornamen.png" class="ornamen-banjar" />
    <img
      src="/static/Image/ornamen_2.png"
      class="ornamen-banjar"
      style="left: -200px; bottom: -130px; width: 700px"
    />
    <script src="/static/js/script.js"></script>
    <script>
      // ==========================
      // SISTEM KUNCI DENGAN DATABASE
      // ==========================

      const isTebakUnlocked =
        "{{ 'true' if unlock_tebak else 'false' }}" === "true";
      const isMatchingUnlocked =
        "{{ 'true' if unlock_matching else 'false' }}" === "true";

      const tebakBox = document.getElementById("kotak_materi_2");
      const matchBox = document.getElementById("kotak_materi_3");

      // Fungsi Mengunci Tampilan & MENGUBAH GAMBAR
      function lockElement(box) {
        // 1. Tambahkan class locked untuk efek abu-abu
        box.classList.add("locked");

        // 2. Cari elemen gambar di dalam kotak ini
        const img = box.querySelector("img");
        if (img) {
          // 3. Ubah sumber gambarnya menjadi gambar gembok
          img.src = "/static/Image/lock.png";

          // Reset style inline agar style dari CSS .locked img bisa diterapkan
          img.style.left = "";
          img.style.width = "";
          img.style.marginTop = "";
        }
      }

      // 1. Cek Status Tebak Gambar
      if (!isTebakUnlocked) {
        if (tebakBox) lockElement(tebakBox);

        const linkTebak = document.getElementById("link_tebak");
        if (linkTebak) {
          linkTebak.addEventListener("click", (e) => {
            e.preventDefault();
            alert(
              "üîí Selesaikan Stage 5 Game Quiz dulu untuk membuka Tebak Gambar!"
            );
          });
        }
      }

      // 2. Cek Status Matching
      if (!isMatchingUnlocked) {
        if (matchBox) lockElement(matchBox);

        const linkMatch = document.getElementById("link_matching");
        if (linkMatch) {
          linkMatch.addEventListener("click", (e) => {
            e.preventDefault();
            alert(
              "üîí Selesaikan Stage 9 Tebak Gambar dulu untuk membuka Matching!"
            );
          });
        }
      }

      function penjelasan() {
        var x = document.querySelector(".buat_profil");
        if (x.style.display === "none") {
          x.style.display = "block";
        } else {
          x.style.display = "none";
        }
      }
    </script>
  </body>
</html>
